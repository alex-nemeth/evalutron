<header class="p-10 text-3xl text-center">
    {{ 'estimationOfWeights.estimation' | translate }}
</header>

<div
    class="flex flex-row h-16 w-full rounded-md justify-center items-center gap-1 mb-4"
>
    <button
        class="bg-primary w-32 h-16 p-4 rounded-l-lg font-bold hover:bg-opacity-80 hover:scale-x-110 active:bg-opacity-40 transition-all"
        [ngClass]="{
            'bg-black text-opacity-75 bg-opacity-30 font-normal hover:bg-opacity-60':
                usingSaatysMethod
        }"
        (click)="usingSaatysMethod = false"
    >
        {{ 'estimationOfWeights.manualComparison' | translate }}
    </button>

    <button
        class="bg-primary w-32 h-16 p-4 rounded-r-lg font-bold hover:bg-opacity-80 hover:scale-x-110 active:bg-opacity-40 transition-all"
        [ngClass]="{
            'bg-black text-opacity-75 bg-opacity-30 font-normal hover:bg-opacity-60':
                !usingSaatysMethod
        }"
        (click)="usingSaatysMethod = true"
    >
        {{ 'estimationOfWeights.saatysMethod' | translate }}
    </button>
</div>

<div class="flex flex-col justify-evenly items-center mx-8">
    <mat-table
        *ngIf="usingSaatysMethod"
        [dataSource]="criteria"
        class="mat-elevation-z8 max-w-full"
        [formGroup]="formGroup"
    >
        <!-- Ghost Cell for Spacing -->
        <ng-container matColumnDef="ghostCell">
            <mat-header-cell *matHeaderCellDef></mat-header-cell>
            <mat-cell *matCellDef="let element">
                {{ element.title }}
            </mat-cell>
        </ng-container>

        <!-- Columns for Criteria -->
        <ng-container
            *ngFor="let criterion of criteria"
            matColumnDef="{{ criterion.id }}"
        >
            <mat-header-cell *matHeaderCellDef class="w-8">
                <div class="flex flex-row gap-2 pt-3">
                    <p>{{ criterion.title }}</p>
                    <mat-icon
                        *ngIf="hasDescription(criterion.title)"
                        [matTooltip]="getTooltip(criterion.title)"
                    >
                        info
                    </mat-icon>
                </div>
            </mat-header-cell>
            <mat-cell *matCellDef="let element">
                <mat-form-field>
                    <input
                        matInput
                        [id]="element.id + '-' + criterion.id"
                        [formControlName]="
                            getFormControlName(element.id, criterion.id)
                        "
                        class="bg-mcea-4 text-black w-20"
                        type="text"
                        placeholder="1-9"
                        (change)="updateWeights($event)"
                        [disabled]="isFieldDisabled(element.id, criterion.id)"
                    />
                </mat-form-field>
            </mat-cell>
        </ng-container>

        <!-- Column for GEOMEAN -->
        <ng-container matColumnDef="geomean">
            <mat-header-cell *matHeaderCellDef class="w-8">{{
                'estimationOfWeights.geomean' | translate
            }}</mat-header-cell>
            <mat-cell *matCellDef="let element">
                <p>
                    {{ hasValue(element.weight) ? element.weight : '1' }}
                </p>
            </mat-cell>
        </ng-container>

        <!-- Column for Weight % -->
        <ng-container matColumnDef="weightPercentage">
            <mat-header-cell *matHeaderCellDef class="w-12">{{
                'estimationOfWeights.weightPercentage' | translate
            }}</mat-header-cell>
            <mat-cell *matCellDef="let element">
                <p>
                    {{
                        hasValue(element.weight)
                            ? ((element.weight / sumOfWeights) * 100).toFixed(3)
                            : (100 / criteria.length).toFixed(3) + '%'
                    }}
                </p>
            </mat-cell>
        </ng-container>

        <!-- Header Row -->
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

        <!-- Data Rows -->
        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
    </mat-table>

    <eval-simple-weight-estimation *ngIf="!usingSaatysMethod" />
</div>
<eval-nav-button-group routeBack="/criteria" routeForward="/alternatives" />
